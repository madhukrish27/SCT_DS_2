import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
train = pd.read_csv('train.csv')  
print("Dataset Info:")
print(train.info())
print("\nMissing values:")
print(train.isnull().sum())
train['Age'].fillna(train['Age'].median(), inplace=True)
train['Embarked'].fillna(train['Embarked'].mode()[0], inplace=True)
train.drop('Cabin', axis=1, inplace=True)  
print("\nCleaned Data Info:")
print(train.info())
plt.figure(figsize=(6, 4))
sns.countplot(x='Survived', data=train)
plt.title("Survival Count")
plt.xlabel("Survived (0 = No, 1 = Yes)")
plt.ylabel("Passenger Count")
plt.show()
plt.figure(figsize=(6, 4))
sns.countplot(x='Survived', hue='Sex', data=train)
plt.title("Survival by Sex")
plt.xlabel("Survived")
plt.ylabel("Count")
plt.legend(title='Sex')
plt.show()
plt.figure(figsize=(6, 4))
sns.countplot(x='Survived', hue='Pclass', data=train)
plt.title("Survival by Passenger Class")
plt.xlabel("Survived")
plt.ylabel("Count")
plt.legend(title='Pclass')
plt.show()
plt.figure(figsize=(8, 5))
sns.histplot(data=train, x='Age', kde=True, bins=30, color='skyblue')
plt.title("Age Distribution of Passengers")
plt.xlabel("Age")
plt.ylabel("Frequency")
plt.show()
plt.figure(figsize=(10, 6))
sns.heatmap(train.corr(numeric_only=True), annot=True, cmap='coolwarm', fmt='.2f')
plt.title("Correlation Heatmap")
plt.show()
train.to_csv('cleaned_titanic_data.csv', index=False)
print("Cleaned dataset saved as 'cleaned_titanic_data.csv'")
